{{ config(schema='yf_clean', materialized='table') }}

select distinct
  ticker,
  timestamp_extracted,
  timezone,
  currency,
  exchange_name,
  instrument_type,
  first_trade_date,
  regular_market_time,
  gmtoffset,
  exchange_timezone_name,
  regular_market_price,
  chart_previous_close,
  previous_close,
  scale,
  price_hint,
  current_trading_period,
  trading_periods,
  data_granularity,
  range,
  valid_ranges,
  current_trading_period_pre_timezone,
  current_trading_period_pre_start,
  current_trading_period_pre_end,
  current_trading_period_pre_gmtoffset,
  current_trading_period_regular_timezone,
  current_trading_period_regular_start,
  current_trading_period_regular_end,
  current_trading_period_regular_gmtoffset,
  current_trading_period_post_timezone,
  current_trading_period_post_start,
  current_trading_period_post_end,
  current_trading_period_post_gmtoffset,
  trading_period_pre_start,
  trading_period_pre_end,
  trading_period_start,
  trading_period_end,
  trading_period_post_start,
  trading_period_post_end,
  full_exchange_name,
  has_pre_post_market_data,
  fifty_two_week_high,
  fifty_two_week_low,
  regular_market_day_high,
  regular_market_day_low,
  regular_market_volume
from
  {{ source('tap_yfinance_dev', 'history_metadata') }}